#!/usr/bin/env bash
set -euo pipefail

REPO_ROOT="$(git rev-parse --show-toplevel 2>/dev/null || pwd)"
if [ -f "$REPO_ROOT/.venv/bin/activate" ]; then
  # shellcheck disable=SC1091
  . "$REPO_ROOT/.venv/bin/activate" || true
fi

if command -v pre-commit >/dev/null 2>&1; then
  exec pre-commit run --hook-stage commit-msg --commit-msg-filename "$1"
fi

# No commit-msg checks configured; allow commit
exit 0
