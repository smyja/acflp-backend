{% extends "layout.html" %}
{% block content %}
  <h2>Flexible JSONL Import</h2>
  {% if error_message %}<div class="alert alert-danger">{{ error_message }}</div>{% endif %}
  {% if success_message %}<div class="alert alert-success">{{ success_message }}</div>{% endif %}

  <form method="post" enctype="multipart/form-data">
    <div class="mb-3"><label class="form-label">File</label>
      <input class="form-control" type="file" name="jsonl_file" accept=".jsonl,.json,application/x-ndjson" required>
    </div>

    <div class="row">
      <div class="col"><label class="form-label">content_field*</label><input class="form-control" name="content_field" placeholder="e.g. data.text or text" required></div>
      <div class="col"><label class="form-label">title_field</label><input class="form-control" name="title_field" placeholder="e.g. meta.title"></div>
      <div class="col"><label class="form-label">description_field</label><input class="form-control" name="description_field"></div>
    </div>
    <div class="row mt-2">
      <div class="col"><label class="form-label">source_language_field</label><input class="form-control" name="source_language_field"></div>
      <div class="col"><label class="form-label">target_language_field</label><input class="form-control" name="target_language_field"></div>
      <div class="col"><label class="form-label">reward_amount_field</label><input class="form-control" name="reward_amount_field"></div>
    </div>

    <h5 class="mt-3">Defaults</h5>
    <div class="row">
      <div class="col"><label class="form-label">default_source_language</label><input class="form-control" name="default_source_language" value="english"></div>
      <div class="col"><label class="form-label">default_target_language</label><input class="form-control" name="default_target_language"></div>
      <div class="col"><label class="form-label">default_task_type</label><input class="form-control" name="default_task_type" value="text_translation"></div>
      <div class="col"><label class="form-label">default_reward_amount</label><input class="form-control" type="number" step="0.01" name="default_reward_amount"></div>
    </div>

    <button class="btn btn-success mt-3" type="submit">Import</button>
  </form>

  {% if import_results %}
    <hr>
    <pre>{{ import_results | tojson }}</pre>
  {% endif %}
{% endblock %}